<div class="nav-box">
  <app-user-nav></app-user-nav>
</div>

<div class="user-stats">
  <div class="spacing"></div>
  <div class="saving-alert">
    <div class="current-saving">
      <h3 appLazyLoadText>Your Savings</h3>
      <h2 appLazyLoadText>{{ currentSaving | currency }}</h2>
    </div>
    <div class="alert-box">
      <mat-icon
        appLazyLoadText
        aria-hidden="false"
        matBadge="2"
        matBadgeSize="small"
        class="alert"
        >notifications</mat-icon
      >
    </div>
  </div>
  <div class="header">
    <div class="user-progress">
      <div class="user-profile">
        <div
          class="outer-circle"
          appProgressCircleAnimation
          [nextPayoutDate]="nextPayoutDate"
          [cycleStartDate]="activeGroups[0].cycleStartDate"
          (daysUntilPayoutChange)="daysUntilPayout = $event"
        >
          <div class="inner-circle-dynamic-fill">
            <div class="img-container">
              <img
                class="profile-img"
                [attr.data-src]="profilePic"
                appLazyLoading
                alt="User Profile"
              />
            </div>
          </div>
        </div>
      </div>
      <p class="payout-days">{{ daysUntilPayout }} days</p>
    </div>

    <div class="demographic">
      <div class="reputation-score">
        <div class="label">Reputation Score</div>
        <div class="value">
          {{ userReputation }} <mat-icon class="rep-score">star</mat-icon>
        </div>
      </div>

      <div class="active-group">
        <div class="label">Active Groups</div>
        <div class="value">{{ activeGroupCount }}</div>
      </div>

      <div class="location">
        <div class="label">Location</div>
        <div class="value">{{ location }}</div>
      </div>
    </div>
  </div>

  <div class="active-groups" *ngFor="let group of activeGroups">
    <div appLazyLoadText class="group-name">
      <mat-icon class="group-icon">groups_3</mat-icon> {{ group.groupName }}
      <span class="divide-vert">|</span>
      @if(group.payoutSystem === 'EPS') {<mat-icon class="styled-icon"
        >calendar_month</mat-icon
      >} @else {<mat-icon class="styled-icon">linear_scale</mat-icon>}
    </div>
    <div class="group-details">
      <div class="outer-progress">
        <div
          class="inner-progress"
          appProgressAnimation
          [rank]="group.rank"
          [groupSize]="group.groupSize"
        ></div>
      </div>
      <div class="section">
        <span class="label">Savings Target: </span>
        <span class="value">{{ group.savingsTarget | currency }}</span>
      </div>
      <div class="section">
        <span class="label">Contribution: </span>
        <span class="value">{{ group.contribution }}</span>
      </div>
      <div class="section">
        <span class="label">Group Size: </span>
        <span class="value">{{ group.groupSize }}</span>
      </div>
      <div class="section">
        <span class="label">Rank: </span>
        <span class="value">{{ group.rank }}</span>
      </div>
      <div class="section">
        <span class="label">Next Due Date: </span>
        <span class="value">{{ group.nextContributionDate | date }}</span>
      </div>
    </div>
  </div>

  <div *ngIf="prevGroups" class="slide-groups prev-groups">
    <div appLazyLoadText class="slide-title">
      <mat-icon class="group-icon clock">watch_later</mat-icon>
      Previous Groups
    </div>
    <swiper-container
      [slides-per-view]="5"
      navigation="false"
      pagination="true"
      scrollbar="false"
      speed="2000"
      [spaceBetween]="20"
    >
    <swiper-slide class="prev-group-slide" *ngFor="let group of prevGroups">
      <app-prev-groups [prevGroup]="group"></app-prev-groups>
    </swiper-slide>
    </swiper-container>
  </div>

</div>

<div *ngIf="trendingGroups" class="slide-groups">
  <div appLazyLoadText class="slide-title">Trending Groups</div>
  <swiper-container
    [slides-per-view]="5"
    navigation="false"
    pagination="true"
    scrollbar="false"
    speed="2000"
    [spaceBetween]="20"
  >
    <swiper-slide *ngFor="let group of trendingGroups">
      <app-trending-groups [trendingGroup]="group"></app-trending-groups>
    </swiper-slide>
  </swiper-container>
</div>
